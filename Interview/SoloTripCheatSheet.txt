===================================================================================
                    üéí 11-NODE SOLO TRIP PLANNER - CHEAT SHEET
===================================================================================

                        For Smart Stay Project
                        solo_trip_graph.py Workflow (HITL)

===================================================================================
                         QUICK OVERVIEW
===================================================================================

WHAT: Personalized solo trip planner with user interaction
HOW: 11 LangGraph nodes with Human-in-the-Loop (HITL)
KEY FEATURE: 4 interrupt points for user preferences
OUTPUT: Highly personalized travel itinerary

WHAT MAKES THIS DIFFERENT FROM TRAVEL PLANNER?
---------------------------------------------
Travel Planner (8-node): Automatic, generic plan
Solo Trip (11-node): Interactive, personalized plan

    Travel Planner: Query ‚Üí AI does everything ‚Üí Result
    Solo Trip: Query ‚Üí AI asks ‚Üí You answer ‚Üí AI asks ‚Üí You answer ‚Üí Personalized Result

===================================================================================
                         WORKFLOW DIAGRAM
===================================================================================

    START
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 1. EXTRACT DETAILS              ‚îÇ ‚Üí Parse query for destination, dates
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 2. ASK TRAVEL MODE              ‚îÇ ‚Üê INTERRUPT (User picks transport)
    ‚îÇ    üöó Car | üöÇ Train | ‚úàÔ∏è Flight ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 3. ASK FOOD PREFERENCE          ‚îÇ ‚Üê INTERRUPT (User picks food type)
    ‚îÇ    ü•ó Veg | üçñ Non-veg | üå± Vegan‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 4. ASK BUDGET                   ‚îÇ ‚Üê INTERRUPT (User picks budget)
    ‚îÇ    üí∞ Budget | üíé Mid | üëë Luxury‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 5. ASK ACCOMMODATION            ‚îÇ ‚Üê INTERRUPT (User picks stay type)
    ‚îÇ    üè® Hotel | üè† Hostel | üè° BnB ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 6. RESEARCH DESTINATION         ‚îÇ ‚Üí Research with preferences in mind
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 7. PLAN TRANSPORT               ‚îÇ ‚Üí Plan based on travel_mode
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 8. PLAN ACCOMMODATION           ‚îÇ ‚Üí Find stays matching budget & type
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 9. PLAN ACTIVITIES              ‚îÇ ‚Üí Solo-friendly activities
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 10. PLAN FOOD                   ‚îÇ ‚Üí Restaurants matching food_preference
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ 11. CREATE ITINERARY            ‚îÇ ‚Üí Compile personalized trip
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
    END (Return personalized itinerary)

===================================================================================
                         STATE DEFINITION
===================================================================================

class SoloTripState(TypedDict):
    # Input
    query: str                  # "Solo trip to Manali"
    
    # Extracted
    destination: str            # "Manali"
    dates: dict                 # {start: "Dec 15", end: "Dec 20"}
    
    # User Preferences (from HITL)
    travel_mode: str            # "car_ev" | "car_petrol" | "train" | "bus" | "flight"
    food_preference: str        # "vegetarian" | "non_vegetarian" | "vegan"
    budget: str                 # "budget" | "mid_range" | "luxury"
    accommodation_type: str     # "hotel" | "hostel" | "homestay" | "resort"
    
    # AI Generated
    destination_research: dict
    transport_plan: dict
    accommodation_plan: dict
    activities_plan: dict
    food_plan: dict
    
    # Final Output
    final_itinerary: dict
    messages: list              # Conversation history

===================================================================================
                         HITL NODE BREAKDOWN
===================================================================================

NODE 2: ASK TRAVEL MODE
-----------------------

def ask_travel_mode(state: SoloTripState) -> dict:
    """Ask user how they want to travel"""
    
    question = {
        "type": "single_choice",
        "question": "How do you prefer to travel?",
        "options": [
            {"value": "car_petrol", "label": "üöó Car (Petrol/Diesel)"},
            {"value": "car_ev", "label": "‚ö° Car (Electric Vehicle)"},
            {"value": "train", "label": "üöÇ Train"},
            {"value": "bus", "label": "üöå Bus"},
            {"value": "flight", "label": "‚úàÔ∏è Flight"}
        ]
    }
    
    # PAUSE - Wait for user
    answer = interrupt(question)
    
    # RESUME - After user answers
    return {"travel_mode": answer}

WHY CAR_EV OPTION?
- If user selects EV, Node 7 will plan charging stops!
- Personalization based on actual needs

---

NODE 3: ASK FOOD PREFERENCE
---------------------------

def ask_food_preference(state: SoloTripState) -> dict:
    """Ask user their food preference"""
    
    question = {
        "type": "single_choice",
        "question": "What's your food preference?",
        "options": [
            {"value": "vegetarian", "label": "ü•ó Vegetarian"},
            {"value": "non_vegetarian", "label": "üçñ Non-Vegetarian"},
            {"value": "vegan", "label": "üå± Vegan"},
            {"value": "eggetarian", "label": "ü•ö Eggetarian"}
        ]
    }
    
    answer = interrupt(question)
    return {"food_preference": answer}

WHY THIS MATTERS?
- Node 10 will ONLY search for matching restaurants
- No more generic "top restaurants" - actual useful results

---

NODE 4: ASK BUDGET
------------------

def ask_budget(state: SoloTripState) -> dict:
    """Ask user their budget level"""
    
    question = {
        "type": "single_choice",
        "question": "What's your budget level?",
        "options": [
            {"value": "budget", "label": "üí∞ Budget (< ‚Çπ2000/day)"},
            {"value": "mid_range", "label": "üíé Mid-Range (‚Çπ2000-5000/day)"},
            {"value": "luxury", "label": "üëë Luxury (> ‚Çπ5000/day)"}
        ]
    }
    
    answer = interrupt(question)
    return {"budget": answer}

---

NODE 5: ASK ACCOMMODATION
-------------------------

def ask_accommodation(state: SoloTripState) -> dict:
    """Ask user preferred accommodation type"""
    
    question = {
        "type": "single_choice", 
        "question": "Where do you prefer to stay?",
        "options": [
            {"value": "hotel", "label": "üè® Hotel"},
            {"value": "hostel", "label": "üè† Hostel (Social, budget)"},
            {"value": "homestay", "label": "üè° Homestay (Local experience)"},
            {"value": "resort", "label": "üèñÔ∏è Resort (Luxury)"}
        ]
    }
    
    answer = interrupt(question)
    return {"accommodation_type": answer}

SOLO TRAVEL TIP:
- Hostels are great for solo travelers (social aspect)
- AI knows this and can recommend accordingly!

===================================================================================
                         PLANNING NODES
===================================================================================

NODE 7: PLAN TRANSPORT (Uses travel_mode)
-----------------------------------------

def plan_transport(state: SoloTripState) -> dict:
    travel_mode = state["travel_mode"]
    
    if travel_mode == "car_ev":
        # Special handling for EV
        search_query = f"EV charging stations route to {destination}"
        # Plan charging stops
        
    elif travel_mode == "car_petrol":
        search_query = f"best road route to {destination}"
        # Plan fuel stops
        
    elif travel_mode == "train":
        search_query = f"trains to {destination} from {source}"
        
    # ... etc
    
    return {"transport_plan": plan}

KEY INSIGHT: Same workflow, different output based on preference!

---

NODE 8: PLAN ACCOMMODATION (Uses budget + accommodation_type)
------------------------------------------------------------

def plan_accommodation(state: SoloTripState) -> dict:
    budget = state["budget"]
    acc_type = state["accommodation_type"]
    
    # Combine preferences
    search_query = f"{acc_type}s in {destination} for {budget} budget"
    
    # If solo + budget = recommend hostels with good reviews
    # If solo + luxury = recommend boutique hotels
    
    return {"accommodation_plan": plan}

---

NODE 10: PLAN FOOD (Uses food_preference)
----------------------------------------

def plan_food(state: SoloTripState) -> dict:
    food_pref = state["food_preference"]
    destination = state["destination"]
    
    search_query = f"best {food_pref} restaurants in {destination}"
    
    # Only vegetarian restaurants for veg preference
    # Include local specialties that match preference
    
    return {"food_plan": plan}

===================================================================================
                         MONGODB CHECKPOINTING
===================================================================================

WHY CHECKPOINT?
--------------
User answers 2 questions ‚Üí closes browser ‚Üí returns next day
Without checkpoint: Start over!
With checkpoint: Continue from question 3!

SETUP:
------
from langgraph.checkpoint.mongodb import MongoDBSaver

checkpointer = MongoDBSaver(
    uri="mongodb://127.0.0.1:27017",
    db_name="smartstay",
    collection_name="solo_trip_checkpoints"
)

solo_trip_graph = graph.compile(checkpointer=checkpointer)

USAGE:
------
# Start new conversation
result = solo_trip_graph.invoke(
    {"query": "Solo trip to Manali"},
    config={"configurable": {"thread_id": "user123_trip1"}}
)

# Resume same conversation
result = solo_trip_graph.invoke(
    Command(resume="vegetarian"),  # User's answer
    config={"configurable": {"thread_id": "user123_trip1"}}  # Same thread_id!
)

===================================================================================
                         API FLOW
===================================================================================

CONVERSATION EXAMPLE:
--------------------

Request 1 (Start):
    POST /api/solo-trip
    {"query": "Plan solo trip to Manali for 5 days"}
    
Response 1 (Question 1):
    {
        "status": "waiting_for_input",
        "question": {
            "question": "How do you prefer to travel?",
            "options": [...]
        },
        "thread_id": "abc123"
    }

Request 2 (Answer 1):
    POST /api/solo-trip
    {"resume_value": "car_ev", "thread_id": "abc123"}
    
Response 2 (Question 2):
    {
        "status": "waiting_for_input",
        "question": {
            "question": "What's your food preference?",
            "options": [...]
        },
        "thread_id": "abc123"
    }

... (2 more Q&A) ...

Request 5 (Answer 4):
    POST /api/solo-trip
    {"resume_value": "hostel", "thread_id": "abc123"}
    
Response 5 (Final Result):
    {
        "status": "completed",
        "result": {
            "final_itinerary": {
                "summary": "5-day Manali trip for solo EV traveler...",
                "transport": {
                    "mode": "Electric Vehicle",
                    "charging_stops": ["Chandigarh", "Sundernagar"],
                    ...
                },
                "accommodation": {
                    "type": "Hostel",
                    "recommendations": ["Zostel Manali", ...],
                    ...
                },
                "food": {
                    "vegetarian_restaurants": [...],
                    ...
                },
                "day_wise": {
                    "day_1": [...],
                    ...
                }
            }
        },
        "thread_id": "abc123"
    }

===================================================================================
                         INTERVIEW TALKING POINTS
===================================================================================

1. "I implemented Human-in-the-Loop using LangGraph's interrupt() function"

2. "The workflow pauses at 4 decision points to collect user preferences"

3. "MongoDB checkpointing allows users to resume interrupted sessions"

4. "Each preference directly influences the planning nodes that follow"

5. "For example, selecting 'EV' changes transport planning to include 
    charging stations - real personalization, not just generic advice"

6. "thread_id uniquely identifies conversations for state persistence"

7. "This pattern is useful whenever AI needs human input mid-workflow"

===================================================================================
                         COMPARISON: 8-NODE VS 11-NODE
===================================================================================

                    8-Node Travel Planner    11-Node Solo Trip
-----------------------------------------------------------------
Interaction         None                     4 questions
Personalization     Generic (preferences)    Highly personalized
State Persistence   Not needed               MongoDB checkpoints
Use Case           Quick overview            Detailed solo planning
Execution          One-shot                  Multi-turn conversation
Special Features   Package comparison        EV support, solo tips

===================================================================================
                         QUICK REFERENCE
===================================================================================

Graph: SoloTripState ‚Üí 11 nodes (4 HITL) ‚Üí Personalized itinerary

HITL Nodes (Interrupt):
2. ask_travel_mode ‚Üí üöó/üöÇ/‚úàÔ∏è
3. ask_food_preference ‚Üí ü•ó/üçñ/üå±
4. ask_budget ‚Üí üí∞/üíé/üëë
5. ask_accommodation ‚Üí üè®/üè†/üè°

Planning Nodes (Use preferences):
6. research_destination
7. plan_transport (uses travel_mode)
8. plan_accommodation (uses budget + type)
9. plan_activities
10. plan_food (uses food_preference)
11. create_itinerary

Key Functions:
- interrupt(question) ‚Üí Pause workflow
- Command(resume=answer) ‚Üí Resume workflow
- MongoDBSaver ‚Üí Persist state
- thread_id ‚Üí Identify conversation

===================================================================================

